{"version":3,"sources":["webpack:///./src/lib-components/kalendar-weekview.vue?f991","webpack:///./src/lib-components/kalendar-day.vue?b96e","webpack:///./src/lib-components/workers/promiseWorker.js","webpack:///./src/lib-components/workers/index.js","webpack:///src/lib-components/kalendar-day.vue","webpack:///./src/lib-components/kalendar-day.vue?9725","webpack:///./src/lib-components/kalendar-day.vue","webpack:///src/lib-components/kalendar-weekview.vue","webpack:///./src/lib-components/kalendar-weekview.vue?1842","webpack:///./src/lib-components/kalendar-weekview.vue","webpack:///./src/lib-components/kalendar-day.vue?8cd8","webpack:///./src/lib-components/kalendar-weekview.vue?666b","webpack:///./src/lib-components/workers/operations.worker.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","style","colsSpace","_l","days","ref","index","value","key","class","today","_isToday","isDayBefore","_v","_s","kalendar_options","formatDayTitle","date","cell_height","_e","staticStyle","hour","hourHeight","formatLeftHours","directives","name","rawName","expression","passedTime","day","activityOfWeek","item","index1","slice","Math","random","toString","substring","refInFor","activities","attrs","distance","available_activities","staticRenderFns","isWeekend","isToday","creating","creator","status","activity","activity_name","cell","day_events","position","temporary_event","on","updateCreator","$event","resetEvents","initiatePopup","worker","messageIds","callbacks","addEventListener","e","onMessage","message","data","Array","isArray","length","messageId","error","result","callback","initiateWorker","_worker","postMessage","userMessage","messageToSend","Promise","resolve","reject","Error","controller","channel","MessageChannel","port1","onmessage","port2","OperationsWorker","promiseWorker","PromiseWorker","send","type","props","created","renderDay","components","kalendarCell","provide","kalendarAddEvent","addEvent","kalendarClearPopups","clearCreatingLeftovers","inject","mounted","scrollToNow","scrollView","computed","methods","validation_message","from","to","removeEvent","eventIndex","events","splice","payload","$kalendar","updateEvents","checkEventValidity","getDayEvents","hasPending","$set","completed","starting_cell","original_starting_cell","current_cell","ending_cell","temporary_id","fixedOverlap","validateSelection","selectCell","event","day_cells","real_ending_cell_index","start","masked_value","startDate","toISOString","rounded","round_offset","end","endDate","diffMins","diffInHrs","updated_events","push","finalEvent","overlapPolice","overlapped","direction","newPayload","console","log","topoffset","setTimeout","window","scroll","component","module","exports","Worker"],"mappings":"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","file":"js/chunk-5d95896f.708d56c4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"calendar-wrap\",style:((\"--space-between-cols: \" + _vm.colsSpace))},[_c('div',{staticClass:\"sticky-top\"},[_c('ul',{staticClass:\"days\"},_vm._l((_vm.days || []),function(ref,index){\nvar value = ref.value;\nreturn _c('li',{key:index,staticClass:\"day-indicator\",class:{\n                    today: _vm._isToday(value),\n                    'is-before': _vm.isDayBefore(value),\n                }},[_c('div',[_c('span',{staticClass:\"letters-date\"},[_vm._v(_vm._s(_vm.kalendar_options.formatDayTitle(value)[0]))]),_c('span',{staticClass:\"number-date\"},[_vm._v(_vm._s(_vm.kalendar_options.formatDayTitle(value)[1]))])])])}),0),_c('ul',{staticClass:\"all-day\"},[_c('span',[_vm._v(\"All Day\")]),_vm._l((_vm.days || []),function(date,index){return _c('li',{key:index,class:{\n                    'all-today': _vm._isToday(date.value),\n                    'is-all-day': false,\n                },style:((\"height:\" + (_vm.kalendar_options.cell_height + 5) + \"px\"))})})],2)]),(false)?_c('div',{staticClass:\"dummy-row\"},[_c('ul',{staticClass:\"dummy-days\"},_vm._l((_vm.days || []),function(day,index){return _c('li',{key:index,style:((\"height:\" + (_vm.kalendar_options.cell_height) + \"px\"))})}),0)]):_vm._e(),(_vm.hours)?_c('div',{staticClass:\"blocks\"},[_c('div',{staticClass:\"calendar-blocks\"},[_c('ul',{staticClass:\"hours\",staticStyle:{\"padding-top\":\"70px\"}},_vm._l((_vm.hoursVisible),function(hour,index){return _c('li',{key:index,staticClass:\"hour-row-identifier\",class:(\"row-\" + index),style:((\"height:\" + _vm.hourHeight + \"px\"))},[_c('span',[_vm._v(_vm._s(_vm.kalendar_options.formatLeftHours(hour.value)))])])}),0),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.kalendar_options.style !== 'material_design'),expression:\"kalendar_options.style !== 'material_design'\"}],staticClass:\"hour-indicator-line\",style:((\"top:\" + (_vm.passedTime.distance) + \"px\"))},[_c('span',{staticClass:\"time-value\"},[_vm._v(_vm._s(_vm.passedTime.value))]),_c('span',{staticClass:\"line\"})]),_vm._l((_vm.days),function(day,index){return _c('div',{staticClass:\"building-blocks-1\"},_vm._l((_vm.activityOfWeek[index].activities),function(item,index1){return _c('kalendar-days',{key:day.value.slice(0, 10)+ Math.random().toString(36).substring(2,7),ref:day.value.slice(0, 10),refInFor:true,staticClass:\"building-blocks\",class:\"day-\" + (index + 1) + \" \" + \"\" + (_vm.activityOfWeek[index].activities[index1].activity_id),attrs:{\"day\":day,\"key\":\"day.value.slice(0, 10) + activityOfWeek[index].activities[index1].activity_id \",\"passed-time\":_vm.passedTime.distance,\"activity\":_vm.activityOfWeek[index].activities[index1],\"position\":index1,\"available_activities\":_vm.available_activities}})}),1)})],2)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',{ref:_vm.day.value + '-reference',staticClass:\"kalendar-day\",class:{\n    'is-weekend': _vm.isWeekend,\n    'is-today': _vm.isToday,\n    creating: _vm.creator.creating || _vm.creator.status === 'popup-initiated'\n  },staticStyle:{\"position\":\"relative\"}},[_c('div',{staticClass:\"building-blocks-activity\"},[_vm._v(_vm._s(_vm.activity.activity_name))]),_vm._l((_vm.day_cells),function(cell,index){return _c('kalendar-cell',{key:(\"cell-\" + index + \"  \" + (_vm.activity.activity_id) + \" \"),attrs:{\"constructed-events\":_vm.day_events,\"creator\":_vm.creator,\"cell-data\":cell,\"day\":_vm.day,\"index\":index,\"activity\":_vm.activity,\"available_activities\":_vm.available_activities,\"position\":_vm.position,\"temporary-event\":_vm.temporary_event},on:{\"select\":_vm.updateCreator,\"reset\":function($event){return _vm.resetEvents()},\"initiatePopup\":function($event){return _vm.initiatePopup()}}})})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function(worker) {\r\n  let messageIds = 0;\r\n  let callbacks = {};\r\n  worker.addEventListener(\"message\", e => onMessage(e));\r\n\r\n  const onMessage = e => {\r\n    const message = e.data;\r\n    if (!Array.isArray(message) || message.length < 2) {\r\n      return;\r\n    }\r\n\r\n    const messageId = message[0];\r\n    const error = message[1];\r\n    const result = message[2];\r\n\r\n    const callback = callbacks[messageId];\r\n\r\n    if (!callback) return;\r\n\r\n    delete callbacks[messageId];\r\n    callback(error, result);\r\n  };\r\n\r\n  return {\r\n    initiateWorker(_worker) {},\r\n    postMessage(userMessage) {\r\n      const messageId = messageIds++;\r\n\r\n      const messageToSend = [messageId, userMessage];\r\n      return new Promise((resolve, reject) => {\r\n        callbacks[messageId] = (error, result) => {\r\n          if (error) return reject(new Error(error.message));\r\n          resolve(result);\r\n        };\r\n\r\n        if (typeof worker.controller !== \"undefined\") {\r\n          // service worker, use MessageChannels because e.source is broken in Chrome < 51:\r\n          // https://bugs.chromium.org/p/chromium/issues/detail?id=543198\r\n          const channel = new MessageChannel();\r\n          channel.port1.onmessage = function(e) {\r\n            onMessage(e);\r\n          };\r\n          worker.controller.postMessage(messageToSend, [channel.port2]);\r\n        } else {\r\n          // web worker\r\n          worker.postMessage(messageToSend);\r\n        }\r\n      });\r\n    }\r\n  };\r\n}\r\n","import PromiseWorker from \"./promiseWorker.js\";\r\nimport OperationsWorker from \"worker-loader!./operations.worker.js\";\r\n//}\r\nconst worker = new OperationsWorker();\r\nconst promiseWorker = PromiseWorker(worker);\r\n\r\nconst send = (type = \"message\", data) =>\r\n\tpromiseWorker.postMessage({\r\n\t\ttype,\r\n\t\tdata\r\n\t});\r\n\r\nexport default {\r\n\tsend\r\n};\r\n","<template>\r\n  <ul\r\n    style=\"position: relative;\"\r\n    :class=\"{\r\n      'is-weekend': isWeekend,\r\n      'is-today': isToday,\r\n      creating: creator.creating || creator.status === 'popup-initiated'\r\n    }\"\r\n    class=\"kalendar-day\"\r\n    :ref=\"day.value + '-reference'\"\r\n  >\r\n  \r\n   <div class=\"building-blocks-activity\">{{activity.activity_name}}</div>\r\n    <kalendar-cell\r\n      v-for=\"(cell, index) in day_cells\"\r\n      :constructed-events=\"day_events\"\r\n      :key=\"`cell-${index}  ${activity.activity_id} `\"\r\n      :creator=\"creator\"\r\n      :cell-data=\"cell\"\r\n      :day=\"day\"\r\n      :index=\"index\"\r\n      :activity=\"activity\"\r\n      :available_activities=\"available_activities\"\r\n      :position=\"position\"\r\n      @select=\"updateCreator\"\r\n      @reset=\"resetEvents()\"\r\n      @initiatePopup=\"initiatePopup()\"\r\n      :temporary-event=\"temporary_event\"\r\n    />\r\n    \r\n  </ul>\r\n</template>\r\n<script>\r\nimport { isToday, isWeekend, cloneObject, getLocaleTime } from \"./utils\";\r\n\r\nimport myWorker from \"@/lib-components/workers\";\r\n\r\nexport default {\r\n  props: [\"day\", \"passedTime\",\"activity\",\"position\",\"available_activities\"],\r\n  created() {\r\n    // get and render day cells\r\n    // and then render any event\r\n    // on top of them\r\n    this.renderDay();\r\n  },\r\n  components: {\r\n    kalendarCell: () => import(\"./kalendar-cell.vue\")\r\n  },\r\n  provide() {\r\n    // provide these methods to children components\r\n    // for easier access\r\n    return {\r\n      kalendarAddEvent: this.addEvent,\r\n      kalendarClearPopups: this.clearCreatingLeftovers\r\n    };\r\n  },\r\n  // inject kalendar options from parent component\r\n  inject: [\"kalendar_options\"],\r\n  mounted() {\r\n    if (this.kalendar_options.scrollToNow && this.isToday) this.scrollView();\r\n  },\r\n  computed: {\r\n    isWeekend() {\r\n      return isWeekend(this.day.value);\r\n    },\r\n    isToday() {\r\n      return isToday(this.day.value);\r\n    }\r\n  },\r\n  data: () => ({\r\n    // this is the main object\r\n    // we use to make selections\r\n    // and control their flows\r\n    creator: {\r\n      creating: false,\r\n      starting_cell: null,\r\n      original_starting_cell: null,\r\n      current_cell: null,\r\n      ending_cell: null,\r\n      status: null\r\n    },\r\n    // temporary event is an object\r\n    // that holds values of creator\r\n    // when the popup is initiated\r\n    temporary_event: null,\r\n\r\n    // day cells and events are used for rendering purposes\r\n    day_cells: [],\r\n    day_events: null\r\n  }),\r\n  methods: {\r\n    renderDay() {\r\n      myWorker\r\n        .send(\"getDayCells\", {\r\n          day: this.day.value,\r\n          hourOptions: {\r\n            start_hour: this.kalendar_options.day_starts_at,\r\n            end_hour: this.kalendar_options.day_ends_at\r\n          }\r\n        })\r\n        .then(reply => {\r\n     \r\n          this.day_cells = reply;\r\n           \r\n          return this.getDayEvents(this.$kalendar.getEvents());\r\n        });\r\n    },\r\n\r\n    addEvent(payload) {\r\n    \r\n      // validation\r\n      let validation_message = this.checkEventValidity(payload);\r\n      if (validation_message !== null) {\r\n        return Promise.reject(validation_message);\r\n      }\r\n      // use web worker to generate event\r\n      // and then render it in the day_events objects\r\n      let { from, to } = payload;\r\n      from = getLocaleTime(from);\r\n      to = getLocaleTime(to);\r\n      return myWorker\r\n        .send(\"constructNewEvent\", {\r\n          event: {\r\n            ...payload,\r\n            from,\r\n            to\r\n          }\r\n        })\r\n        .then(constructed_event => {\r\n          let { key } = constructed_event;\r\n               console.log(this.day_events  )\r\n              // must use $set since key wasnt present in the object\r\n              // vue will fail to render it\r\n              this.$set(this.day_events, key, [constructed_event]);\r\n            \r\n          let events = this.$kalendar.getEvents();\r\n          events.push({\r\n            ...payload,\r\n            id: constructed_event.id\r\n          });\r\n         \r\n          this.$kalendar.updateEvents(events);\r\n        });\r\n    },\r\n\r\n    // this is not called inside this component\r\n    // but rather from the kalendar-weekview component\r\n    // which targets it using $refs object.\r\n    removeEvent(payload) {\r\n      let events = this.$kalendar.getEvents();\r\n      let eventIndex = events.findIndex(event => event.id === payload.id);\r\n      if (eventIndex < 0) return;\r\n      events.splice(eventIndex, 1);\r\n      let index = this.day_events[payload.key].findIndex(\r\n        event => event.id === payload.id\r\n      );\r\n      this.day_events[payload.key].splice(index, 1);\r\n      this.$kalendar.updateEvents(events);\r\n      return Promise.resolve();\r\n    },\r\n    checkEventValidity(payload) {\r\n      let { from, to } = payload;\r\n      if (!from || !to) return \"No dates were provided in the payload\";\r\n      /*if (isoFrom !== from) {\r\n        return 'From date is not ISO format';\r\n      }\r\n      if (isoTo !== to) {\r\n        return 'To date is not ISO format';\r\n      }*/\r\n      return null;\r\n    },\r\n    getDayEvents(events) {\r\n  \r\n      let clonedEvents = events.filter(event => {return event.activity_id==this.activity.activity_id})\r\n      return myWorker\r\n        .send(\"constructDayEvents\", {\r\n          events: clonedEvents,\r\n          day: this.day.value\r\n        })\r\n        .then(constructed_events => {\r\n          this.day_events = constructed_events;\r\n        });\r\n    },\r\n    clearCreatingLeftovers() {\r\n      for (let key in this.day_events) {\r\n        let hasPending = this.day_events[key].some(event => {\r\n          return (\r\n            event.status === \"popup-initiated\" || event.status === \"creating\"\r\n          );\r\n        });\r\n        if (hasPending) {\r\n          let completed = this.day_events[key].filter(\r\n            event => event.status === \"completed\"\r\n          );\r\n          this.$set(this.day_events, key, completed);\r\n          if (completed.length === 0) {\r\n            delete this.day_events[key];\r\n          }\r\n        }\r\n      }\r\n      this.resetEvents();\r\n    },\r\n    resetEvents() {\r\n      if (!this.creator.creating && this.creator.status === null) return;\r\n      this.creator = {\r\n        creating: false,\r\n        starting_cell: null,\r\n        original_starting_cell: null,\r\n        current_cell: null,\r\n        ending_cell: null,\r\n        status: null,\r\n        temporary_id: null\r\n      };\r\n      this.temporary_event = null;\r\n    },\r\n\r\n    // this method is what we use\r\n    // to start the flow of selecting a new cell\r\n    // while the creator is enabled\r\n    updateCreator(payload) {\r\n      this.creator = {\r\n        ...this.validateSelection(payload),\r\n        status: \"creating\"\r\n      };\r\n      if (\r\n        this.kalendar_options.overlap === false &&\r\n        Object.keys(this.day_events).length > 0\r\n      ) {\r\n        let fixedOverlap = this.overlapPolice(payload);\r\n        if (fixedOverlap) {\r\n          this.creator = this.validateSelection(fixedOverlap);\r\n          this.selectCell();\r\n          this.initiatePopup();\r\n          return;\r\n        }\r\n      }\r\n      this.selectCell();\r\n    },\r\n\r\n    // when the direction is reversed,\r\n    // the ending cell is actually the originally selected cell\r\n    validateSelection(event) {\r\n      let { original_starting_cell, starting_cell, current_cell } = event;\r\n      if (\r\n        event.direction === \"reverse\" &&\r\n        original_starting_cell.index > current_cell.index\r\n      ) {\r\n        return {\r\n          ...event,\r\n          starting_cell: current_cell,\r\n          ending_cell: original_starting_cell\r\n        };\r\n      }\r\n      return event;\r\n    },\r\n    selectCell() {\r\n      if (!this.creator.creating) return;\r\n      let {\r\n        creating,\r\n        ending_cell,\r\n        current_cell,\r\n        starting_cell,\r\n        original_starting_cell\r\n      } = this.creator;\r\n\r\n      let real_ending_cell_index = ending_cell.index + 1;\r\n      ending_cell = this.day_cells[real_ending_cell_index];\r\n\r\n      const diffInMs =\r\n        new Date(ending_cell.value) - new Date(starting_cell.value);\r\n      const diffInHrs = Math.floor((diffInMs % 86400000) / 3600000);\r\n      const diffMins = Math.round(((diffInMs % 86400000) % 3600000) / 60000);\r\n      let startDate = new Date(starting_cell.value);\r\n      let endDate = new Date(ending_cell.value);\r\n\r\n      let distance = diffMins + diffInHrs * 60;\r\n\r\n      this.temporary_event = {\r\n        start: {\r\n          masked_value: startDate.toISOString(),\r\n          value: startDate.toISOString(),\r\n          rounded: false,\r\n          round_offset: null\r\n        },\r\n        end: {\r\n          masked_value: endDate.toISOString(),\r\n          value: endDate.toISOString(),\r\n          rounded: false,\r\n          round_offset: null\r\n        },\r\n        distance: distance,\r\n        status: \"creating\"\r\n      };\r\n    },\r\n    initiatePopup() {\r\n      if (this.creating && this.creator.status !== \"creating\") return;\r\n      this.creator = {\r\n        ...this.creator,\r\n        status: \"popup-initiated\",\r\n        creating: false\r\n      };\r\n      let {\r\n        ending_cell,\r\n        current_cell,\r\n        starting_cell,\r\n        original_starting_cell\r\n      } = this.creator;\r\n      let real_ending_cell_index = ending_cell.index + 1;\r\n      ending_cell = this.day_cells[real_ending_cell_index];\r\n\r\n      const diffInMs =\r\n        new Date(ending_cell.value) - new Date(starting_cell.value);\r\n      const diffInHrs = Math.floor((diffInMs % 86400000) / 3600000);\r\n      const diffMins = Math.round(((diffInMs % 86400000) % 3600000) / 60000);\r\n      let startDate = new Date(starting_cell.value);\r\n      let endDate = new Date(ending_cell.value);\r\n\r\n      let finalEvent = {\r\n        start: {\r\n          masked_value: startDate.toISOString(),\r\n          value: startDate.toISOString(),\r\n          rounded: false,\r\n          round_offset: null\r\n        },\r\n        end: {\r\n          masked_value: endDate.toISOString(),\r\n          value: endDate.toISOString(),\r\n          rounded: false,\r\n          round_offset: null\r\n        },\r\n        distance: diffMins + diffInHrs * 60,\r\n        status: \"popup-initiated\"\r\n      };\r\n\r\n      let updated_events = this.day_events[starting_cell.value];\r\n      if (!updated_events) updated_events = [];\r\n      updated_events.push(finalEvent);\r\n      this.$set(this.day_events, starting_cell.value, updated_events);\r\n      this.temporary_event = null;\r\n    },\r\n    overlapPolice(payload) {\r\n      if (!payload.current_cell) return;\r\n      let overlapped = Object.keys(this.day_events)\r\n        .map(evKey => {\r\n          return this.day_events[evKey];\r\n        })\r\n        .flat()\r\n        .filter(event => {\r\n          let cellStart = new Date(payload.starting_cell.value);\r\n          let cellEnd = new Date(payload.ending_cell.value);\r\n          let eventStarts = new Date(event.start.value);\r\n          let eventEnds = new Date(event.end.value);\r\n          return (\r\n            (cellEnd > eventStarts && cellEnd < eventEnds) ||\r\n            (cellStart < eventStarts && cellEnd > eventStarts)\r\n          );\r\n        });\r\n      if (!overlapped || overlapped.length === 0) {\r\n        return;\r\n      }\r\n      let newPayload = payload;\r\n      if (payload.direction === \"reverse\") {\r\n        let needed_cell = overlapped[0].end;\r\n        let event_cell = this.day_cells.find(\r\n          c => c.value === needed_cell.masked_value\r\n        );\r\n        let cell = this.day_cells[event_cell.index];\r\n        newPayload.starting_cell = {\r\n          value: cell.value,\r\n          index: cell.index\r\n        };\r\n        newPayload.current_cell = {\r\n          value: cell.value,\r\n          index: cell.index\r\n        };\r\n      } else {\r\n        let needed_cell = overlapped[0].start;\r\n        let event_cell = this.day_cells.find(\r\n          c => c.value === needed_cell.masked_value\r\n        );\r\n        let cell = this.day_cells[event_cell.index - 1];\r\n        newPayload.ending_cell = {\r\n          value: cell.value,\r\n          index: cell.index\r\n        };\r\n      }\r\n      return newPayload;\r\n    },\r\n    scrollView() {\r\n      let topoffset = this.$refs.nowIndicator.offsetTop;\r\n      console.log(\"Scrolling to :\", topoffset);\r\n      setTimeout(() => {\r\n        window.scroll({ top: topoffset, left: 0, behavior: \"smooth\" });\r\n      }, 500);\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\">\r\nul.kalendar-day {\r\n  position: relative;\r\n  background-color: white;\r\n  .building-blocks-activity {\r\n     font-size: 14px;\r\n     border-right: 1px solid #d6d1d3;\r\n     border-bottom: 1px solid #d6d1d3;\r\n     height:80px;\r\n     text-align: center;\r\n    }\r\n  .kalendar-cell{\r\n       height:50px\r\n     }\r\n  &.is-weekend {\r\n    background-color: var(--weekend-color);\r\n  }\r\n\r\n  &.is-today {\r\n    background-color: var(--current-day-color);\r\n  }\r\n\r\n  .clear {\r\n    position: absolute;\r\n    z-index: 1;\r\n    top: -20px;\r\n    right: 0;\r\n    font-size: 10px;\r\n  }\r\n\r\n  &.creating {\r\n    z-index: 11;\r\n\r\n    .created-event {\r\n      pointer-events: none;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-day.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-day.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kalendar-day.vue?vue&type=template&id=f157c914&\"\nimport script from \"./kalendar-day.vue?vue&type=script&lang=js&\"\nexport * from \"./kalendar-day.vue?vue&type=script&lang=js&\"\nimport style0 from \"./kalendar-day.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div class=\"calendar-wrap\" :style=\"`--space-between-cols: ${colsSpace}`\">\r\n        <div class=\"sticky-top\">\r\n            <ul class=\"days\">\r\n                <li\r\n                    class=\"day-indicator\"\r\n                    :key=\"index\"\r\n                    v-for=\"({ value }, index) in days || []\"\r\n                    :class=\"{\r\n                        today: _isToday(value),\r\n                        'is-before': isDayBefore(value),\r\n                    }\"\r\n                >\r\n                    <div>\r\n                        <span class=\"letters-date\">{{\r\n                            kalendar_options.formatDayTitle(value)[0]\r\n                        }}</span>\r\n                        <span class=\"number-date\">{{\r\n                            kalendar_options.formatDayTitle(value)[1]\r\n                        }}</span>\r\n                        \r\n                    </div>\r\n                </li>\r\n            </ul>\r\n            <ul class=\"all-day\">\r\n                <span>All Day</span>\r\n                <li\r\n                    :key=\"index\"\r\n                    v-for=\"(date, index) in days || []\"\r\n                    :class=\"{\r\n                        'all-today': _isToday(date.value),\r\n                        'is-all-day': false,\r\n                    }\"\r\n                    :style=\"`height:${kalendar_options.cell_height + 5}px`\"\r\n                ></li>\r\n            </ul>\r\n        </div>\r\n        <div class=\"dummy-row\" v-if=\"false\">\r\n            <ul class=\"dummy-days\">\r\n                <li\r\n                    :key=\"index\"\r\n                    v-for=\"(day, index) in days || []\"\r\n                    :style=\"`height:${kalendar_options.cell_height}px`\"\r\n                ></li>\r\n            </ul>\r\n        </div>\r\n        <div class=\"blocks\" v-if=\"hours\">\r\n            <div class=\"calendar-blocks\">\r\n                <ul class=\"hours\" style=\"padding-top:70px\">\r\n                    <li\r\n                        class=\"hour-row-identifier\"\r\n                        :key=\"index\"\r\n                      \r\n                        v-for=\"(hour, index) in hoursVisible\"\r\n                        :class=\"`row-${index}`\"\r\n                          :style=\"`height:${hourHeight}px`\"\r\n                    >\r\n                    \r\n                        <span>{{\r\n                            kalendar_options.formatLeftHours(hour.value) \r\n                        }}</span>\r\n                    </li>\r\n                </ul>\r\n             \r\n                <div\r\n                    v-show=\"kalendar_options.style !== 'material_design'\"\r\n                    class=\"hour-indicator-line\"\r\n                    :style=\"`top:${passedTime.distance}px`\"\r\n                >\r\n                    <span class=\"time-value\">{{ passedTime.value }}</span>\r\n                    <span class=\"line\"></span>\r\n                </div>\r\n                   \r\n                <div  class=\"building-blocks-1\" v-for=\"(day, index) in days\">\r\n                <kalendar-days\r\n                  :key=\"day.value.slice(0, 10)+ Math.random().toString(36).substring(2,7)\"\r\n                  v-for=\"(item, index1) in activityOfWeek[index].activities\"\r\n                    :day=\"day\"\r\n                    class=\"building-blocks\"\r\n                    :class=\"`day-${index + 1} ` + `${activityOfWeek[index].activities[index1].activity_id}` \"\r\n                    key=\"day.value.slice(0, 10) + activityOfWeek[index].activities[index1].activity_id \"\r\n                    :passed-time=\"passedTime.distance\"\r\n                    :ref=\"day.value.slice(0, 10)\"\r\n                    :activity=\"activityOfWeek[index].activities[index1]\"\r\n                    :position=\"index1\"\r\n                    :available_activities=\"available_activities\"\r\n                >\r\n                \r\n                </kalendar-days>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport KalendarDays from './kalendar-day.vue';\r\nimport myWorker from '@/lib-components/workers';\r\nimport axios from \"axios\";\r\nimport {\r\n    isBefore,\r\n    isToday,\r\n    getHourlessDate,\r\n    addTimezoneInfo,\r\n    getLocaleTime,\r\n} from './utils';\r\n\r\nexport default {\r\n    \r\n    props: {\r\n        current_day: {\r\n            required: true,\r\n            type: String,\r\n            validator: d => !isNaN(Date.parse(d)),\r\n        },\r\n        activityOfWeek: {\r\n            required: true,\r\n            type: Array,\r\n            validator: function(val) {\r\n                return Array.isArray(val);\r\n            },\r\n        },\r\n        available_activities: {\r\n            required: true,\r\n            type: Array,\r\n            validator: function(val) {\r\n                return Array.isArray(val);\r\n            },\r\n        },\r\n        pos: {\r\n           type: Number,\r\n           default: 0,\r\n           required: true\r\n       }\r\n    },\r\n    components: {\r\n        KalendarDays,\r\n    },\r\n    created() {\r\n        this.addHelperMethods();\r\n        setInterval(() => (this.kalendar_options.now = new Date()), 1000 * 60);\r\n        this.constructWeek();\r\n    },\r\n    inject: ['kalendar_options', 'kalendar_events'],\r\n    data: () => ({\r\n     \r\n        hours: null,\r\n        days: [],\r\n     \r\n    }),\r\n    computed: {\r\n        hoursVisible() {\r\n            if (!this.hours) return [];\r\n            return this.hours.filter(x => !!x.visible);\r\n        },\r\n        colsSpace() {\r\n            return this.kalendar_options.style === 'flat_design'\r\n                ? '5px'\r\n                : '0px';\r\n        },\r\n        hourHeight() {\r\n            return 6 * this.kalendar_options.cell_height;\r\n            //this.kalendar_options.cell_height * (60 / this.kalendar_options.split_value);\r\n            // * this.kalendar_options.hour_parts;\r\n        },\r\n        passedTime() {\r\n            let { day_starts_at, day_ends_at, now } = this.kalendar_options;\r\n            let time = getLocaleTime(now);\r\n            let day_starts = `${time.split('T')[0]}T${(\r\n                day_starts_at + ''\r\n            ).padStart(2, '0')}:00:00.000Z`;\r\n            let day_ends = `${time.split('T')[0]}T${(day_ends_at + '').padStart(\r\n                2,\r\n                '0'\r\n            )}:00:00.000Z`;\r\n            let time_obj = new Date(time);\r\n\r\n            if (\r\n                new Date(day_ends) < time_obj ||\r\n                time_obj < new Date(day_starts)\r\n            )\r\n                return null;\r\n\r\n            let distance = (time_obj - new Date(day_starts)) / 1000 / 60;\r\n            return { distance, time };\r\n        },\r\n    },\r\n    methods: {\r\n        _isToday(day) {\r\n            return isToday(day);\r\n        },\r\n        updateAppointments({ id, data }) {\r\n            this.$emit('update', { id, data });\r\n        },\r\n        deleteAppointment(id) {\r\n            this.$emit('delete', { id });\r\n        },\r\n        clearAppointments() {\r\n            this.$emit('clear');\r\n        },\r\n        isDayBefore(day) {\r\n            let now = new Date(this.kalendar_options.now);\r\n            let formattedNow = getLocaleTime(now.toISOString());\r\n            return isBefore(day, getHourlessDate(formattedNow));\r\n        },\r\n        constructWeek() {\r\n            const date = this.current_day.slice(0, 10);\r\n            const { hide_dates, hide_days, view_type } = this.kalendar_options;\r\n            return Promise.all([\r\n                myWorker\r\n                    .send('getDays', {\r\n                        day: date,\r\n                        options: {\r\n                            hide_dates,\r\n                            hide_days,\r\n                            view_type,\r\n                        },\r\n                    })\r\n                    .then(reply => {\r\n                        this.days = reply; //.slice(0,1);\r\n                       \r\n                    }),\r\n                myWorker\r\n                    .send('getHours', {\r\n                        hourOptions: {\r\n                            start_hour: this.kalendar_options.day_starts_at,\r\n                            end_hour: this.kalendar_options.day_ends_at,\r\n                        },\r\n                    })\r\n                    .then(reply => {\r\n                        // Handle the reply\r\n                        this.hours = reply;\r\n                    }),\r\n            ]);\r\n        },\r\n        addHelperMethods() {\r\n            this.$kalendar.buildWeek = () => {\r\n                this.constructWeek();\r\n            };\r\n            this.$kalendar.updatePayload = index1 =>{\r\n                this.pos=index1\r\n            }\r\n            this.$kalendar.addNewEvent = payload => {\r\n               if (!payload) return Promise.reject('No payload');  \r\n                let { from, to } = payload;\r\n                if (from.slice(-4) === '000Z')\r\n                    payload.from = addTimezoneInfo(from);\r\n                if (to.slice(-4) === '000Z') payload.to = addTimezoneInfo(to);\r\n                let targetRef = payload.from.slice(0, 10);\r\n                \r\n                const refObject = this.$refs[targetRef];\r\n                let _pos=this.pos\r\n                 const activity_id = parseInt(refObject[this.pos].$el.classList[refObject[this.pos].$el.classList.length-1])\r\n                axios.post(`http://www.learningbali.com/strapi/api/activity/book`,\r\n                        {\r\n                             \"activity_id\":activity_id,\r\n                             \"datetime_start\": payload.from,\r\n                             \"datetime_end\": payload.to,\r\n                             \"num_of_participants\":parseInt(payload.data.num_of_participants),\r\n                             \"age_min\":parseInt(payload.data.age_min), \r\n                             \"age_max\":parseInt(payload.data.age_max),\r\n                        })\r\n                    .then(function (response) {\r\n                           refObject[_pos].addEvent(payload);\r\n                    })\r\n\t\t\t          .catch(function (error) {\r\n                       console.log(error);\r\n                        })\r\n            \r\n                    \r\n                   \r\n            }\r\n            this.$kalendar.removeEvent = options => {\r\n               \r\n                let { day, key, id } = options;\r\n                if (day.length > 10) {\r\n                    day = day.slice(0, 10);\r\n                }\r\n\r\n                if (!day) return Promise.reject(\"Day wasn't provided\");\r\n                if (!id) return Promise.reject('No ID was provided');\r\n                if (!key)\r\n                    return Promise.reject('No key was provided in the object');\r\n                let targetRef = day;\r\n                this.$refs[targetRef][this.pos].removeEvent({ id, key });\r\n            };\r\n\r\n            this.$kalendar.closePopups = () => {\r\n\r\n                let refs = this.days.map(day => day.value.slice(0, 10));\r\n                refs.forEach(ref => {\r\n                    this.$refs[ref].map(item=>item.clearCreatingLeftovers())\r\n                });\r\n            };\r\n        },\r\n    },\r\n};\r\n</script>\r\n<style lang=\"scss\">\r\n$blue: #5fb3f2;\r\n$lblue: #d6eefc;\r\n$dblue: #3d79b4;\r\n$lightgrey: #c7c9d5; //$lightgrey: #F5F4F5;\r\n$grey: #c7c9d5; //#C1C4C8;\r\n$a-grey: #666;\r\n$border-color: transparent;\r\n$theme-color: #e5e5e5;\r\n\r\n.calendar-wrap {\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 1327px;\r\n    margin-left: 11px;\r\n    border-left: 1px solid #d6d1d3;\r\n    border-bottom: 1px solid #d6d1d3;\r\n    ul {\r\n        list-style: none;\r\n        padding: 0px;\r\n\r\n        > li {\r\n            display: flex;\r\n        }\r\n    }\r\n}\r\n\r\n.sticky-top {\r\n    position: sticky;\r\n    top: 0;\r\n    z-index: 20;\r\n    background-color: white;\r\n\r\n    .days {\r\n        margin: 0px;\r\n        display: flex;\r\n        margin-left: 55px;\r\n\r\n        li {\r\n            display: inline-flex;\r\n            align-items: flex-end;\r\n            padding-top: 10px;\r\n            flex: 1;\r\n            font-size: 1.1rem;\r\n            color: $a-grey;\r\n            font-weight: 300;\r\n            margin-right: var(--space-between-cols);\r\n            border-bottom: solid 1px #e5e5e5;\r\n            padding-bottom: 5px;\r\n            position: relative;\r\n            font-size: 18px;\r\n\r\n            span {\r\n                margin-right: 3px;\r\n            }\r\n\r\n            span:first-child {\r\n                font-size: 20px;\r\n                font-weight: 500;\r\n            }\r\n        }\r\n\r\n        .today {\r\n            border-bottom-color: var(--main-color);\r\n            color: var(--main-color) !important;\r\n        }\r\n\r\n        .today::after {\r\n            content: '';\r\n            position: absolute;\r\n            height: 2px;\r\n            bottom: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            background-color: var(--main-color);\r\n        }\r\n    }\r\n\r\n    .all-day {\r\n        display: flex;\r\n        margin-bottom: 0px; //border-top: solid 1px #e5e5e5;\r\n        margin-top: 0px;\r\n        border-bottom: solid 2px #e5e5e5;\r\n\r\n        span {\r\n            display: flex;\r\n            align-items: center;\r\n            padding: 0px 5px;\r\n            width: 55px;\r\n            font-weight: 500;\r\n            font-size: 0.8rem;\r\n            color: darken($grey, 5);\r\n            text-transform: lowercase;\r\n        }\r\n\r\n        li {\r\n            flex: 1; //border-right: solid 5px $border-color;\r\n            margin-right: var(--space-between-cols);\r\n\r\n            &.all-today {\r\n                background-color: #fef4f4;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n.dummy-row {\r\n    display: flex;\r\n    padding-left: 55px;\r\n\r\n    ul {\r\n        display: flex;\r\n        flex: 1;\r\n        margin: 0px;\r\n    }\r\n\r\n    li {\r\n        flex: 1;\r\n        height: 15px; //border-right: solid 5px $border-color;\r\n        margin-right: var(--space-between-cols);\r\n        border-bottom: solid 1px #e5e5e5;\r\n    }\r\n}\r\n\r\n.blocks {\r\n    display: flex;\r\n    position: relative;\r\n    height: 100%;\r\n\r\n    ul {\r\n        margin-top: 0px;\r\n    }\r\n \r\n    .building-blocks {\r\n        flex: 1;\r\n        margin-right: var(--space-between-cols);\r\n        margin-bottom: 0px;\r\n        display: flex;\r\n        flex-direction: column;\r\n    }\r\n  .building-blocks-1 {\r\n        flex: 1;\r\n        margin-right: var(--space-between-cols);\r\n        margin-bottom: 0px;\r\n        display: flex;\r\n        flex-direction: row;\r\n        .remove{\r\n            display:none\r\n        }\r\n    }\r\n    .calendar-blocks {\r\n        width: 100%;\r\n        display: flex;\r\n        position: relative;\r\n    }\r\n}\r\n\r\n\r\n.hours {\r\n  display: flex;\r\n  flex-direction: column;\r\n  color: darken($grey, 5);\r\n  font-weight: 500;\r\n  font-size: 0.85rem;\r\n  width: 55px;\r\n  height: 100%;\r\n  margin-bottom: 0px;\r\n\r\n  li {\r\n    color: var(--hour-row-color);\r\n    border-bottom: solid 1px $border-color;\r\n    padding-left: 8px;\r\n\r\n    span {\r\n      margin-top: -8px;\r\n    }\r\n  }\r\n  .row-11{\r\n      height: 0px !important;\r\n  }\r\n\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-weekview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-weekview.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kalendar-weekview.vue?vue&type=template&id=057fd76e&\"\nimport script from \"./kalendar-weekview.vue?vue&type=script&lang=js&\"\nexport * from \"./kalendar-weekview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./kalendar-weekview.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-day.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-day.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-weekview.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kalendar-weekview.vue?vue&type=style&index=0&lang=scss&\"","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"13a62894b123ef52636d.worker.js\");\n};"],"sourceRoot":""}